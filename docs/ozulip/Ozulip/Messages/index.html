<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Messages (ozulip.Ozulip.Messages)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.1.1"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> – <a href="../../index.html">ozulip</a> &#x00BB; <a href="../index.html">Ozulip</a> &#x00BB; Messages</nav><header class="odoc-preamble"><h1>Module <code><span>Ozulip.Messages</span></code></h1><p>Message requests</p></header><nav class="odoc-toc"><ul><li><a href="#message-destination">Message destination</a></li><li><a href="#message-selection">Message selection</a></li><li><a href="#requests">Requests</a></li></ul></nav><div class="odoc-content"><h2 id="message-destination"><a href="#message-destination" class="anchor"></a>Message destination</h2><div class="odoc-spec"><div class="spec type" id="type-destination" class="anchored"><a href="#type-destination" class="anchor"></a><code><span><span class="keyword">type</span> destination</span></code></div><div class="spec-doc"><p>Destination information</p></div></div><div class="odoc-spec"><div class="spec value" id="val-private_emails" class="anchored"><a href="#val-private_emails" class="anchor"></a><code><span><span class="keyword">val</span> private_emails : <span><span>string list</span> <span class="arrow">&#45;&gt;</span></span> <a href="#type-destination">destination</a></span></code></div><div class="spec-doc"><p><code>private_emails emails</code> create destination for private message with users with giving <code>emails</code> emails.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-private_ids" class="anchored"><a href="#val-private_ids" class="anchor"></a><code><span><span class="keyword">val</span> private_ids : <span><span>int list</span> <span class="arrow">&#45;&gt;</span></span> <a href="#type-destination">destination</a></span></code></div><div class="spec-doc"><p><code>private_ids ids</code> create destination for private message with users with giving <code>ids</code> ids.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-stream_name" class="anchored"><a href="#val-stream_name" class="anchor"></a><code><span><span class="keyword">val</span> stream_name : <span>string <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <a href="#type-destination">destination</a></span></code></div><div class="spec-doc"><p><code>stream_name name topic</code> create destination for stream message with specified stream name <code>name</code> under the topic <code>topic</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-stream_id" class="anchored"><a href="#val-stream_id" class="anchor"></a><code><span><span class="keyword">val</span> stream_id : <span>int <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <a href="#type-destination">destination</a></span></code></div><div class="spec-doc"><p><code>stream_id id topic</code> create destination for stream message with specified stream id <code>id</code> under the topic <code>topic</code>.</p></div></div><h2 id="message-selection"><a href="#message-selection" class="anchor"></a>Message selection</h2><div class="odoc-spec"><div class="spec type" id="type-propagate_mode" class="anchored"><a href="#type-propagate_mode" class="anchor"></a><code><span><span class="keyword">type</span> propagate_mode</span><span> = </span></code><table><tr id="type-propagate_mode.One" class="anchored"><td class="def variant constructor"><a href="#type-propagate_mode.One" class="anchor"></a><code><span>| </span><span><span class="constructor">One</span></span></code></td></tr><tr id="type-propagate_mode.Later" class="anchored"><td class="def variant constructor"><a href="#type-propagate_mode.Later" class="anchor"></a><code><span>| </span><span><span class="constructor">Later</span></span></code></td></tr><tr id="type-propagate_mode.All" class="anchored"><td class="def variant constructor"><a href="#type-propagate_mode.All" class="anchor"></a><code><span>| </span><span><span class="constructor">All</span></span></code></td></tr></table></div><div class="spec-doc"><p>Indicates which message(s) should be edited.</p></div></div><h2 id="requests"><a href="#requests" class="anchor"></a>Requests</h2><div class="odoc-spec"><div class="spec value" id="val-send_message" class="anchored"><a href="#val-send_message" class="anchor"></a><code><span><span class="keyword">val</span> send_message : 
  <span>?queue_id:string <span class="arrow">&#45;&gt;</span></span>
  <span>?local_id:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">Ozulip__Config.config</span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-destination">destination</a> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span>int option</span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>send_message ~queue_id ~local_id config dest content</code> sends a stream or a private message with content <code>content</code>. Returns message's id. <code>config</code> is connection configuration. <code>dest</code> is a message destination created with <code>stream_*</code> functions for stream's message and <code>private_*</code> for private message. <code>queue_id</code> event queue ID for client supporting local echo. <code>local_id</code> a unique string-format identifier for client supporting local echo.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-upload_file" class="anchored"><a href="#val-upload_file" class="anchor"></a><code><span><span class="keyword">val</span> upload_file : <span><span class="xref-unresolved">Ozulip__Config.config</span> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span><span>string option</span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>upload_file config path</code> uploads a single file under the path <code>path</code>. Retruns corresponding URI of the file on the server.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-edit_message" class="anchored"><a href="#val-edit_message" class="anchor"></a><code><span><span class="keyword">val</span> edit_message : 
  <span>?topic:string <span class="arrow">&#45;&gt;</span></span>
  <span>?stream_id:string <span class="arrow">&#45;&gt;</span></span>
  <span>?content:string <span class="arrow">&#45;&gt;</span></span>
  <span>?prop_mode:<a href="#type-propagate_mode">propagate_mode</a> <span class="arrow">&#45;&gt;</span></span>
  <span>?notif_old:bool <span class="arrow">&#45;&gt;</span></span>
  <span>?notif_new:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">Ozulip__Config.config</span> <span class="arrow">&#45;&gt;</span></span>
  <span>int <span class="arrow">&#45;&gt;</span></span>
  <span>bool <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>edit_message ~topic ~stream_id ~content ~prop_mode ~notif_old ~notif_new config id</code> edits/updates the content, topic, or stream of a message. Returns boolean that tells if request was succesfull. <code>topic</code> the topic to move the message(s) to, to request changing the topic. <code>stream_id</code> the stream ID to move the message(s) to, to request moving messages to another stream. <code>content</code> the updated content of the target message. Note that a message's content and stream cannot be changed at the same time. <code>prop_mode</code> tells which message(s) should be edited. <code>notif_old</code> whether to send breadcrumb message to the old thread to notify users where the messages were moved to. <code>notif_new</code> whether to send a notification message to the new thread to notify users where the messages came from.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-delete_message" class="anchored"><a href="#val-delete_message" class="anchor"></a><code><span><span class="keyword">val</span> delete_message : <span><span class="xref-unresolved">Ozulip__Config.config</span> <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> <span>bool <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>delete_message config id</code> permanently delete a message with giving id. Returns boolean that tells if request was succesfull.</p></div></div></div></body></html>